<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AresNyX - Premium Boxer Shorts Shop</title>
    
    <style>
    /* ===== CRITICAL CSS ===== */
    :root {
        --primary-dark: #121212;
        --accent-gold: #D4AF37;
        --success: #27AE60;
        --danger: #E74C3C;
        --gray-light: #F8F9FA;
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
        font-family: 'Montserrat', sans-serif;
        background: #fff; color: #2C3E50; line-height: 1.6;
        display: flex; flex-direction: column; min-height: 100vh;
    }
    
    /* HEADER */
    .header { 
        background: var(--primary-dark); padding: 1rem 2rem; 
        position: sticky; top: 0; z-index: 1000; 
    }
    .navbar { display: flex; justify-content: space-between; align-items: center; max-width: 1400px; margin: 0 auto; }
    .logo { font-size: 2rem; font-weight: 700; color: var(--accent-gold); text-decoration: none; letter-spacing: 3px; }
    .cart-icon { position: relative; cursor: pointer; padding: 0.5rem 1rem; color: #fff; font-size: 1.1rem; }
    .cart-count { position: absolute; top: -8px; right: -8px; background: var(--danger); color: white; border-radius: 50%; padding: 2px 6px; font-size: 0.8em; font-weight: 600; }
    
    /* PRODUCTS GRID */
    .products-section { padding: 3rem 2rem; max-width: 1400px; margin: 0 auto; flex: 1; }
    .products-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; }
    .product-card { background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.1); cursor: pointer; transition: all 0.3s ease; }
    .product-card:hover { transform: translateY(-5px); box-shadow: 0 15px 35px rgba(0,0,0,0.15); }
    .product-image { width: 100%; height: 200px; object-fit: cover; background: #f7f7f7; }
    .product-info { padding: 1.2rem; }
    .product-title { font-size: 1.1rem; font-weight: 600; margin-bottom: 0.5rem; }
    .product-material { color: #666; font-size: 0.9rem; margin-bottom: 0.8rem; }
    .product-price { font-size: 1.2rem; font-weight: 700; }
    
    /* MODAL */
    .modal-overlay { 
        display: none; position: fixed; top: 0; left: 0; 
        width: 100%; height: 100%; background: rgba(0,0,0,0.9); 
        z-index: 2000; 
    }
    .modal-container { 
        position: absolute; top: 50%; left: 50%; 
        transform: translate(-50%, -50%); 
        background: white; border-radius: 16px; 
        width: 90%; max-width: 500px;
        max-height: 80vh;
        overflow-y: auto; 
    }
    .modal-close { 
        position: absolute; top: 1rem; right: 1rem; 
        background: rgba(0,0,0,0.5); color: white; 
        border: none; width: 40px; height: 40px; 
        border-radius: 50%; cursor: pointer; z-index: 10; 
        font-size: 1.2rem; 
    }
    .modal-content { padding: 2rem; }
    
    .modal-gallery { text-align: center; margin-bottom: 1rem; }
    .modal-main-image { 
        width: 100%; max-width: 300px;
        height: 200px;
        object-fit: cover; border-radius: 10px; margin-bottom: 1rem; 
    }
    
    .modal-details h2 { font-size: 1.4rem; margin-bottom: 0.5rem; }
    .modal-material { color: #666; margin-bottom: 1rem; }
    .modal-price { font-size: 1.3rem; font-weight: 700; margin-bottom: 1.5rem; }
    
    /* SIZE SELECTION */
    .size-section { margin-bottom: 1.5rem; }
    .size-section h3 { margin-bottom: 1rem; }
    .size-selector { display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem; margin-bottom: 1rem; }
    .size-option { 
        padding: 1rem 0.5rem; border: 2px solid #E9ECEF; 
        border-radius: 8px; text-align: center; cursor: pointer; 
        font-weight: 500; background: white; 
    }
    .size-option.selected { border-color: var(--accent-gold); background: var(--accent-gold); color: var(--primary-dark); }
    
    /* QUANTITY */
    .quantity-section { margin-bottom: 1.5rem; }
    .quantity-section h3 { margin-bottom: 1rem; }
    .quantity-selector { display: flex; align-items: center; gap: 1rem; max-width: 200px; }
    .qty-btn { 
        width: 40px; height: 40px; border: 2px solid #E9ECEF; 
        background: white; border-radius: 8px; cursor: pointer; 
        font-size: 1.2rem; font-weight: bold; 
    }
    .qty-display { font-size: 1.2rem; font-weight: 600; min-width: 50px; text-align: center; padding: 0.5rem; background: #F8F9FA; border-radius: 8px; }
    
    /* ACTIONS */
    .modal-actions { display: flex; gap: 1rem; margin-top: 2rem; }
    .add-to-cart-btn { 
        flex: 1;
        background: var(--primary-dark); color: white; 
        border: none; padding: 1rem 1.5rem;
        border-radius: 8px; font-size: 1.1rem; font-weight: 600; 
        cursor: pointer; 
    }
    
    /* CART */
    .cart-sidebar { 
        position: fixed; top: 0; right: -400px; width: 400px; 
        height: 100vh; background: white; box-shadow: -5px 0 25px rgba(0,0,0,0.1); 
        transition: right 0.3s ease; z-index: 1500; display: flex; flex-direction: column; 
    }
    .cart-sidebar.active { right: 0; }
    .cart-header { 
        padding: 1.5rem; border-bottom: 1px solid #E9ECEF; 
        display: flex; justify-content: space-between; align-items: center; 
        background: var(--primary-dark); color: white; 
    }
    .cart-items { flex: 1; overflow-y: auto; padding: 1rem; }
    .cart-item { 
        display: flex; gap: 1rem; padding: 1rem 0; 
        border-bottom: 1px solid #E9ECEF; align-items: center; 
        position: relative;
    }
    .cart-item-remove {
        position: absolute;
        top: 0.5rem;
        right: 0;
        background: var(--danger);
        color: white;
        border: none;
        width: 25px;
        height: 25px;
        border-radius: 50%;
        cursor: pointer;
    }
    .cart-item-image { width: 70px; height: 70px; object-fit: cover; border-radius: 8px; }
    .cart-item-details { flex: 1; }
    .cart-item-title { font-weight: 600; margin-bottom: 0.3rem; }
    .cart-item-size { color: #666; font-size: 0.85rem; margin-bottom: 0.5rem; }
    .cart-item-controls { 
        display: flex; align-items: center; gap: 0.8rem; 
    }
    .cart-item-qty-btn { 
        width: 30px; height: 30px; border: 1px solid #E9ECEF; 
        background: white; border-radius: 4px; cursor: pointer; 
        font-weight: bold; 
    }
    .cart-item-qty { 
        padding: 0.3rem 0.8rem; background: #F8F9FA; 
        border-radius: 4px; font-weight: 600; min-width: 40px; 
        text-align: center; 
    }
    .cart-item-price { font-weight: 600; }
    
    .cart-actions { padding: 1rem; border-top: 1px solid #E9ECEF; }
    .clear-cart-btn { 
        width: 100%; background: var(--danger); color: white; 
        border: none; padding: 0.8rem; border-radius: 6px; 
        cursor: pointer; font-weight: 500; 
    }
    
    .cart-footer { padding: 1.5rem; border-top: 1px solid #E9ECEF; background: #F8F9FA; }
    .cart-totals { margin-bottom: 1rem; }
    .cart-total-row { 
        display: flex; justify-content: space-between; 
        margin-bottom: 0.5rem; 
    }
    .cart-total-row.final { 
        font-weight: 700; font-size: 1.2rem; 
        border-top: 2px solid #E9ECEF; padding-top: 0.8rem; 
        margin-top: 0.5rem; 
    }
    .checkout-btn { 
        width: 100%; background: var(--success); color: white; 
        border: none; padding: 1.2rem; border-radius: 8px; 
        font-size: 1.1rem; font-weight: 600; cursor: pointer; 
    }
    .empty-cart { text-align: center; padding: 3rem 1rem; color: #666; }
    
    .toast { 
        position: fixed; bottom: 2rem; right: 2rem; 
        background: var(--success); color: white; padding: 1rem 1.5rem; 
        border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
        transform: translateX(400px); transition: transform 0.3s ease; 
        z-index: 3000; 
    }
    .toast.show { transform: translateX(0); }
    </style>
    
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header class="header">
        <nav class="navbar">
            <a href="index.html" class="logo">ARESNYX</a>
            <div class="cart-icon" onclick="toggleCart()">
                <i class="fas fa-shopping-bag"></i>
                <span class="cart-count" id="cartCount">0</span>
            </div>
        </nav>
    </header>

    <main class="main-content">
        <section class="products-section">
            <div class="products-grid" id="productsGrid"></div>
        </section>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">ARESNYX</div>
            <p class="footer-tagline">Premium kvalitet. Izuzetan komfor. Vaš stil.</p>
        </div>
    </footer>

    <!-- Modal -->
    <div class="modal-overlay" id="productModal">
        <div class="modal-container">
            <button class="modal-close" onclick="closeModal()">×</button>
            <div class="modal-content">
                <div class="modal-gallery">
                    <img class="modal-main-image" id="modalMainImage" src="" alt="">
                </div>
                
                <div class="modal-details">
                    <h2 id="modalTitle"></h2>
                    <p class="modal-material" id="modalMaterial"></p>
                    <p class="modal-price" id="modalPrice"></p>
                    
                    <div class="size-section">
                        <h3>Odaberite veličinu:</h3>
                        <div class="size-selector" id="sizeSelector"></div>
                    </div>

                    <div class="quantity-section">
                        <h3>Količina:</h3>
                        <div class="quantity-selector">
                            <button class="qty-btn" onclick="changeQuantity(-1)">-</button>
                            <span class="qty-display" id="modalQty">1</span>
                            <button class="qty-btn" onclick="changeQuantity(1)">+</button>
                        </div>
                    </div>

                    <div class="modal-actions">
                        <button class="add-to-cart-btn" onclick="addToCartFromModal()">
                            <i class="fas fa-shopping-cart"></i> Dodaj u Korpu
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart -->
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h3>Vaša Korpa</h3>
            <button class="modal-close" onclick="toggleCart()">×</button>
        </div>
        <div class="cart-items" id="cartItems">
            <div class="empty-cart" id="emptyCart">
                <i class="fas fa-shopping-bag"></i>
                <p>Vaša korpa je prazna</p>
            </div>
        </div>
        
        <div class="cart-actions" id="cartActions" style="display: none;">
            <button class="clear-cart-btn" onclick="clearCart()">
                <i class="fas fa-trash"></i> Isprazni Korpu
            </button>
        </div>
        
        <div class="cart-footer" id="cartFooter" style="display: none;">
            <div class="cart-totals">
                <div class="cart-total-row"><span>Međuzbir:</span><span id="cartSubtotal">0 RSD</span></div>
                <div class="cart-total-row"><span>Poštarina:</span><span id="cartShipping">0 RSD</span></div>
                <div class="cart-total-row"><span>Popust:</span><span id="cartDiscount">0 RSD</span></div>
                <div class="cart-total-row final"><span>Ukupno:</span><span id="cartTotal">0 RSD</span></div>
            </div>
            <button class="checkout-btn" onclick="checkout()"><i class="fas fa-lock"></i> Završi Kupovinu</button>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <script>
    // ===== JEDNOSTAVAN I RADNI KOD =====
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    let currentProduct = null;
    let currentSize = 'M';
    let currentQuantity = 1;

    const products = [
        { id: 1, name: "Classic Pamuk", material: "100% Organski Pamuk", price: 1300, images: ["images/pamuk-1.jpg"] },
        { id: 2, name: "Premium Lan", material: "100% Premium Lan", price: 1500, images: ["images/lan-1.jpg"] },
        { id: 3, name: "Elegant Svila", material: "100% Prirodna Svila", price: 1800, images: ["images/svila-1.jpg"] },
        { id: 4, name: "Night Black", material: "100% Premium Pamuk", price: 1300, images: ["images/crna-1.jpg"] },
        { id: 5, name: "Pure White", material: "100% Organski Pamuk", price: 1300, images: ["images/bela-1.jpg"] },
        { id: 6, name: "Navy Stripes", material: "100% Premium Pamuk", price: 1400, images: ["images/navy-1.jpg"] }
    ];

    // INICIJALIZACIJA
    function init() {
        renderProducts();
        updateCartCount();
        renderCart();
    }

    // RENDER PROIZVODA
    function renderProducts() {
        const grid = document.getElementById('productsGrid');
        grid.innerHTML = products.map(product => `
            <div class="product-card" onclick="openProductModal(${product.id})">
                <img src="${product.images[0]}" alt="${product.name}" class="product-image">
                <div class="product-info">
                    <h3 class="product-title">${product.name}</h3>
                    <p class="product-material">${product.material}</p>
                    <p class="product-price">${product.price} RSD</p>
                </div>
            </div>
        `).join('');
    }

    // MODAL
    function openProductModal(productId) {
        currentProduct = products.find(p => p.id === productId);
        if (!currentProduct) return;

        currentSize = 'M';
        currentQuantity = 1;

        document.getElementById('modalTitle').textContent = currentProduct.name;
        document.getElementById('modalMaterial').textContent = currentProduct.material;
        document.getElementById('modalPrice').textContent = `${currentProduct.price} RSD`;
        document.getElementById('modalQty').textContent = '1';
        document.getElementById('modalMainImage').src = currentProduct.images[0];

        const sizeSelector = document.getElementById('sizeSelector');
        sizeSelector.innerHTML = ['M', 'L', 'XL', 'XXL'].map(size => `
            <div class="size-option ${size === 'M' ? 'selected' : ''}" onclick="selectSize('${size}')">${size}</div>
        `).join('');

        document.getElementById('productModal').style.display = 'block';
    }

    function closeModal() {
        document.getElementById('productModal').style.display = 'none';
    }

    function selectSize(size) {
        currentSize = size;
        document.querySelectorAll('.size-option').forEach(opt => opt.classList.remove('selected'));
        event.target.classList.add('selected');
    }

    function changeQuantity(change) {
        currentQuantity = Math.max(1, currentQuantity + change);
        document.getElementById('modalQty').textContent = currentQuantity;
    }

    // DODAVANJE U KORPU - INSTANT
    function addToCartFromModal() {
        if (!currentProduct) return;
        
        // DODAJ U KORPU
        addToCart(currentProduct.id, currentSize, currentQuantity);
        
        // OSVEŽI PRIKAZ
        updateCartCount();
        renderCart();
        
        // PRIKAŽI PORUKU
        showToast(`${currentProduct.name} je dodat u korpu!`);
        
        // ZATVORI MODAL
        closeModal();
    }

    function addToCart(productId, size, quantity) {
        const product = products.find(p => p.id === productId);
        const existingItem = cart.find(item => item.productId === productId && item.size === size);

        if (existingItem) {
            existingItem.quantity += quantity;
        } else {
            cart.push({
                productId,
                size, 
                quantity,
                name: product.name,
                price: product.price,
                image: product.images[0]
            });
        }

        localStorage.setItem('cart', JSON.stringify(cart));
    }

    // KORPA
    function updateCartCount() {
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        document.getElementById('cartCount').textContent = totalItems;
    }

    function renderCart() {
        const cartItems = document.getElementById('cartItems');
        const cartFooter = document.getElementById('cartFooter');
        const cartActions = document.getElementById('cartActions');
        const emptyCart = document.getElementById('emptyCart');

        if (cart.length === 0) {
            emptyCart.style.display = 'block';
            cartFooter.style.display = 'none';
            cartActions.style.display = 'none';
            cartItems.innerHTML = '';
            cartItems.appendChild(emptyCart);
            return;
        }

        emptyCart.style.display = 'none';
        cartFooter.style.display = 'block';
        cartActions.style.display = 'block';

        cartItems.innerHTML = cart.map((item, index) => `
            <div class="cart-item">
                <button class="cart-item-remove" onclick="removeCartItem(${index})">×</button>
                <img src="${item.image}" alt="${item.name}" class="cart-item-image">
                <div class="cart-item-details">
                    <div class="cart-item-title">${item.name}</div>
                    <div class="cart-item-size">Veličina: ${item.size}</div>
                    <div class="cart-item-controls">
                        <button class="cart-item-qty-btn" onclick="updateCartItem(${index}, -1)">-</button>
                        <span class="cart-item-qty">${item.quantity}</span>
                        <button class="cart-item-qty-btn" onclick="updateCartItem(${index}, 1)">+</button>
                        <span class="cart-item-price">${item.price * item.quantity} RSD</span>
                    </div>
                </div>
            </div>
        `).join('');

        updateCartTotals();
    }

    function updateCartItem(index, change) {
        cart[index].quantity += change;
        
        if (cart[index].quantity < 1) {
            cart.splice(index, 1);
        }
        
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartCount();
        renderCart();
    }

    function removeCartItem(index) {
        cart.splice(index, 1);
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartCount();
        renderCart();
    }

    function updateCartTotals() {
        const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        const shipping = totalItems >= 5 ? 0 : (totalItems > 0 ? 400 : 0);
        const discount = totalItems >= 7 ? Math.round(subtotal * 0.1) : 0;
        const total = subtotal + shipping - discount;

        document.getElementById('cartSubtotal').textContent = subtotal + ' RSD';
        document.getElementById('cartShipping').textContent = shipping + ' RSD';
        document.getElementById('cartDiscount').textContent = discount + ' RSD';
        document.getElementById('cartTotal').textContent = total + ' RSD';
    }

    function clearCart() {
        if (cart.length === 0) return;
        cart = [];
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartCount();
        renderCart();
        showToast("Korpa je ispražnjena!");
    }

    function toggleCart() {
        document.getElementById('cartSidebar').classList.toggle('active');
    }

    function checkout() {
        if (cart.length === 0) return;
        showToast(`Porudžbina uspešna!`);
        cart = [];
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartCount();
        renderCart();
        toggleCart();
    }

    function showToast(message) {
        const toast = document.getElementById('toast');
        toast.textContent = message;
        toast.classList.add('show');
        setTimeout(() => toast.classList.remove('show'), 2000);
    }

    // POKRENI
    init();

    // EVENT LISTENERI
    document.addEventListener('click', (e) => {
        if (e.target.classList.contains('modal-overlay')) {
            closeModal();
        }
    });
    </script>
</body>
</html>
